image: AWS_ACCOUNT_ID.dkr.ecr.us-east-1.amazonaws.com/ECR_REPO_NAME:TAG # specify image explicitly

environment: staging

port: 2000 # specify port explicitly
targetPort: 8000

ingress:
  class: alb
  scheme: internet-facing
  targetType: ip
  certificateArn: arn:aws:acm:us-east-1:346486810583:certificate/31bd3160-a3a2-44d2-805a-8bf241eee9f4

serviceAccountName: prosperi-services-staging-sa

app:
  resources:
    requests:
      memory: "96M"
      cpu: "0.05"
  replicaCount: 1
  args: [ "gunicorn", "src.core.wsgi:application", "--bind", "0.0.0.0:8000" ]
  enabled: true

consumer:
  resources:
    requests:
      memory: "96M"
      cpu: "0.05"
  replicaCount: 1
  args: [ "python3", "-m", "src.consumer" ]
  enabled: false

dbMigrationJob:
  enabled: true
  args: [ "python3", "src/manage.py", "migrate" ]

collectStaticJob:
  resources:
    requests:
      memory: "96M"
      cpu: "0.05"
  args: [ "python3", "src/manage.py", "collectstatic", "--noinput" ]
  enabled: true

secrets:
  awsSecretName: prosperi/ENVIRONMENT/SECRET_NAME # specify secret name explicitly
  envs:
    - name: database_url
    - name: environment
    - name: rabbitmq_url
    - name: redis_url
    - name: sentry_dsn
